/* js/story_data/story_horror.js */
(function() {
    // 1. å–å¾—æ ¸å¿ƒæ´»é ç°¿
    const DB = window.FragmentDB;
    if (!DB) {
        console.error("âŒ éŒ¯èª¤ï¼šæ‰¾ä¸åˆ° FragmentDBï¼Œè«‹ç¢ºèª story_data_core.js å·²å„ªå…ˆè¼‰å…¥ã€‚");
        return;
    }

    // 2. è¿½åŠ åŠ‡æœ¬ (Templates)
    DB.templates.push(
        // ============================================================
        // [BLOCK B] ğŸ‘» ç¾ä»£å¿ƒç†ææ€–æµ (Asian Psychological Horror)
        // ============================================================
        {
            type: 'setup_omen', id: 'hor_psych_setup',
            // [ä¿®æ­£] æ”¹ç”¨ {sentence_env_vibe} ç¢ºä¿æ–‡æ³•é€šé †
            text: { zh: [ "é€™è£¡æœ¬è©²æ˜¯ä½ ç†Ÿæ‚‰çš„{noun_location_room}ï¼Œä½†æ­¤åˆ»çœ‹èµ·ä¾†å»ç•°å¸¸é™Œç”Ÿã€‚", "{sentence_env_vibe}ï¼Œç‰†è§’çš„é™°å½±ä¼¼ä¹æ¯”å¹³å¸¸æ›´æ·±ã€æ›´æ¿ƒã€‚", "ä½ {atom_manner}åœä¸‹è…³æ­¥ï¼Œç¸½è¦ºå¾—æœ‰æŸç¨®è¦–ç·šæ­£åœ¨å¾{noun_env_feature}çš„ç¸«éš™ä¸­çªºè¦–è‘—ä½ ã€‚" ]},
            dialogue: [{ speaker: "æ—ç™½", text: { zh: "ï¼ˆè€³é‚Šå‚³ä¾†ä¸€é™£è‹¥æœ‰ä¼¼ç„¡çš„ç«Šç¬‘è²ï¼Œè½èµ·ä¾†æ—¢åƒè€äººï¼Œåˆåƒå¬°å…’...ï¼‰" } }],
            options: [
                { label: "å¼·è£é®å®šï¼Œå¿½è¦–å°æ–¹", action: "advance_chain", rewards: { tags: ['horror_started'], varOps: [{ key: 'sanity', val: 90, op: 'set' }] } },
                { label: "æª¢æŸ¥è²éŸ³çš„ä¾†æº", action: "advance_chain", rewards: { tags: ['horror_started', 'marked_by_curse'], varOps: [{ key: 'sanity', val: 80, op: 'set' }] }, nextScene: { text: "ä½ æ¹Šè¿‘ä¸€çœ‹ï¼Œé‚£è£¡ä»€éº¼éƒ½æ²’æœ‰ï¼Œåªæœ‰ä¸€åœ˜ç³¾çµçš„é»‘è‰²é«®çµ²ï¼Œæ•£ç™¼è‘—è…¥è‡­å‘³ã€‚" } }
            ]
        },
        {
            type: 'encounter_stalk', id: 'hor_psych_stalk',
            // [ä¿®æ­£] ç§»é™¤æœªå®šç¾©çš„ verb_move_univ
            text: { zh: [ "ä½ è©¦åœ–é›¢é–‹ï¼Œä½†èµ°å»Šå½·å½¿æ²’æœ‰ç›¡é ­ã€‚èº«å¾Œå‚³ä¾†äº†ã€Œå•ªå—’ã€å•ªå—’ã€çš„æ¿•é»è…³æ­¥è²ã€‚", "é‚£è²éŸ³æ¥µä¸è¦å¾‹ï¼Œå°±åƒæ˜¯æŸç¨®è‚¢é«”æ‰­æ›²çš„æ±è¥¿ï¼Œæ­£æ‰‹è…³ä¸¦ç”¨åœ¨åœ°ä¸Š{atom_manner}çˆ¬è¡Œã€‚", "å°æ–¹æ­£åœ¨é€¼è¿‘ï¼Œè€Œä¸”å°æ–¹çŸ¥é“ä½ åœ¨å“ªè£¡ã€‚" ]},
            dialogue: [{ speaker: "ï¼Ÿï¼Ÿï¼Ÿ", text: { zh: "å˜»å˜»... æ‰¾åˆ°... ä½ äº†..." } }],
            options: [
                // [ä¿®æ­£] å°‡ nextTags æ”¹ç‚ºæ¨™æº–çš„ rewards: { tags: [...] }
                { label: "å±ä½å‘¼å¸ï¼Œèº²é€²æ­»è§’", style: "primary", check: { stat: 'INT', val: 5 }, action: "advance_chain", nextScene: { text: "ä½ æ‘€ä½å£é¼»ï¼Œå¿ƒè‡ŸåŠ‡çƒˆè·³å‹•ã€‚é‚£æ±è¥¿åœåœ¨ä½ çš„è—èº«è™•å¤–ï¼Œç™¼å‡ºäº†æŒ‡ç”²åˆ®æ“¦åœ°æ¿çš„è²éŸ³... ç„¶å¾Œæ…¢æ…¢é›¢é–‹äº†ã€‚" }, failScene: { text: "ææ‡¼è®“ä½ ç™¼å‡ºäº†å–˜æ¯è²ã€‚é‚£è…³æ­¥è²ç«‹åˆ»åœäº†ä¸‹ä¾†ï¼Œç„¶å¾ŒçŒ›åœ°è½‰å‘ä½ ï¼", rewards: { tags: ['danger_high'], varOps: [{key:'sanity', val:20, op:'-'}] } } },
                { label: "ä¸è¦å›é ­ï¼Œç‹‚å¥”ï¼", action: "advance_chain", rewards: { tags: ['risk_high'] }, nextScene: { text: "ä½ {atom_manner}å‘å‰è¡åˆºï¼Œæ„Ÿè¦ºå†°å†·çš„æ‰‹æŒ‡æ“¦éäº†ä½ çš„å¾Œé ¸..." } }
            ]
        },
        {
            type: 'encounter_climax', id: 'hor_psych_look',
            // [ä¿®æ­£] å°‡ noun_role_monster å°é½Šæ ¸å¿ƒåº«çš„ noun_monster
            text: { zh: [ "ç„¡è·¯å¯é€€äº†ã€‚é‚£å€‹{noun_monster}ï¼ˆæˆ–è€…èªªæ˜¯æ›¾ç¶“æ˜¯äººçš„æ±è¥¿ï¼‰å°±æ‡¸æ›åœ¨å¤©èŠ±æ¿ä¸Šã€‚", "å°æ–¹çš„é ­é¡±ä»¥è©­ç•°çš„è§’åº¦è½‰äº†180åº¦ï¼Œæ­»ç™½è‰²çš„çœ¼ç æ­£æ­»æ­»ç›¯è‘—ä½ ã€‚", "æ‰€æœ‰çš„æœ¬èƒ½éƒ½åœ¨å°–å«ï¼šçµ•å°ä¸èƒ½å’Œå°æ–¹å°è¦–ã€‚" ]},
            options: [
                { label: "ç·Šé–‰é›™çœ¼ï¼Œå”¸èª¦ç¥ˆç¦±", action: "advance_chain", check: { stat: 'LUK', val: 5 }, nextScene: { text: "ä½ æ„Ÿåˆ°ä¸€è‚¡å†°å†·çš„æ°£æ¯è²¼è‘—è‡‰é °æ»‘éï¼Œè€³é‚Šæ˜¯éª¨éª¼æ‘©æ“¦çš„è„†éŸ¿... ä½†æœ€çµ‚ï¼Œå°æ–¹ä¼¼ä¹å°éœæ­¢çš„çµç‰©å¤±å»äº†èˆˆè¶£ã€‚" }, failScene: { text: "ä½ å¿ä¸ä½çœé–‹äº†ä¸€æ¢ç¸«... ä¸€å¼µå¸ƒæ»¿è¡€çµ²çš„è‡‰æ­£è²¼åœ¨ä½ çš„é¼»å°–å‰ï¼Œéœ²å‡ºäº†è£‚åˆ°è€³æ ¹çš„ç¬‘å®¹ã€‚", rewards: { varOps: [{key:'sanity', val:50, op:'-'}] } } },
                { label: "ç”¨æ‰‹é›»ç­’å¼·å…‰ç…§å°„å°æ–¹ï¼", style: "danger", action: "finish_chain", nextScene: { text: "å…‰ç·šç…§äº®äº†å°æ–¹çš„å…¨è²Œâ€”â€”é‚£æ™¯è±¡è¶…è¶Šäº†äººé¡ç†æ™ºçš„æ¥µé™ã€‚ä½ çš„æ„è­˜åœ¨å°–å«ä¸­æ–·ç·šäº†ã€‚\nã€çµå±€ï¼šç²¾ç¥å´©æ½°ã€‘" } }
            ]
        },
        {
            type: 'final_survival', id: 'hor_psych_end',
            text: { zh: [ "ä¸çŸ¥é“éäº†å¤šä¹…ï¼Œå‘¨åœçµ‚æ–¼æ¢å¾©äº†æ­»å¯‚ã€‚ä½ {atom_manner}æ¨é–‹é–€ï¼Œè¡é€²äº†å¤–é¢çš„é™½å…‰ä¸­ã€‚", "äººç¾¤çš„å–§å›‚è²è®“ä½ æ„Ÿåˆ°ä¸€é™£ææƒšã€‚ä½ ä»¥ç‚ºä½ é€ƒæ‰äº†ã€‚", "ä½†ç•¶ä½ ä½é ­çœ‹æ™‚ï¼Œç™¼ç¾è‡ªå·±çš„è…³è¸ä¸Šï¼Œå¤šäº†ä¸€å€‹é’ç´«è‰²çš„æ‰‹å°ï¼Œè€Œä¸”...é‚„åœ¨ç™¼ç‡™ã€‚" ]},
            options: [{ label: "é€™åªæ˜¯ä¸€å€‹é–‹å§‹...", action: "finish_chain", rewards: { removeTags: ['horror_started', 'danger_high'], title: "å€–å­˜è€…(ï¼Ÿ)", exp: 300 } }]
        },
        
        // ============================================================
        // [é€šç”¨æ“´å……] å…¶ä»–æ‡¸ç–‘/ææ€–é–‹å ´
        // ============================================================
        {
            type: 'setup',
            id: 'mys_setup_letter',
            text: { zh: [
                "ä¸€åˆ‡éƒ½å§‹æ–¼é‚£å°å¥‡æ€ªçš„ä¿¡ã€‚",
                "ä¿¡ä¸Šèªªï¼Œé—œæ–¼çœŸç›¸ï¼Œå°±è—åœ¨é€™åº§èŠåœ’è£¡ã€‚",
                "å¤–é¢çš„{atom_weather}è®“é€™ä¸€åˆ‡é¡¯å¾—æ›´åŠ è©­ç•°ã€‚"
            ]},
            options: [
                { label: "æ¨é–‹èŠåœ’å¤§é–€", action: "advance_chain" }
            ]
        },
        {
            type: 'setup_omen', 
            id: 'hor_setup_omen',
            text: { zh: [
                "ä½ ä¸è©²ä¾†é€™è£¡çš„ã€‚",
                "{atom_weather}ï¼Œä½ çš„è»Šæ‹‹éŒ¨åœ¨äº†åŠè·¯ã€‚",
                "é è™•é‚£æ£Ÿå»¢æ£„çš„{combo_building}ä¼¼ä¹æ˜¯ä½ å”¯ä¸€çš„é¿é›£æ‰€ã€‚"
            ]},
            options: [
                { label: "ç¡¬è‘—é ­çš®é€²å»", action: "advance_chain" }
            ]
        }
    );

    console.log("ğŸ•µï¸â€â™‚ï¸ ææ€–åŠ‡æœ¬å·²è¼‰å…¥");
})();