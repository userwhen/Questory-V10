/* js/story_data/story_horror.js */
(function() {
    // 1. å–å¾—æ ¸å¿ƒæ´»é ç°¿
    const DB = window.FragmentDB;
    if (!DB) {
        console.error("âŒ éŒ¯èª¤ï¼šæ‰¾ä¸åˆ° FragmentDBï¼Œè«‹ç¢ºèª story_data_core.js å·²å„ªå…ˆè¼‰å…¥ã€‚");
        return;
    }

    // ğŸ›¡ï¸ é˜²å‘†é‡‘ç‰Œ
    DB.templates = DB.templates || [];

    // 2. è¿½åŠ åŠ‡æœ¬ (Templates)
    DB.templates.push(
        // ============================================================
        // [BLOCK B] ğŸ‘» ç¾ä»£å¿ƒç†ææ€–æµ (Asian Psychological Horror)
        // ============================================================
        {
            type: 'setup_omen', id: 'hor_psych_setup',
            dialogue: [
                { text: { zh: "é€™è£¡æœ¬è©²æ˜¯ä½ ç†Ÿæ‚‰çš„{noun_location_room}ï¼Œä½†æ­¤åˆ»çœ‹èµ·ä¾†å»ç•°å¸¸é™Œç”Ÿã€‚" } },
                { text: { zh: "{sentence_env_vibe}ï¼Œç‰†è§’çš„é™°å½±ä¼¼ä¹æ¯”å¹³å¸¸æ›´æ·±ã€æ›´æ¿ƒã€‚" } },
                { text: { zh: "ä½ {atom_manner}åœä¸‹è…³æ­¥ï¼Œç¸½è¦ºå¾—æœ‰æŸç¨®è¦–ç·šæ­£åœ¨å¾{noun_env_feature}çš„ç¸«éš™ä¸­çªºè¦–è‘—ä½ ã€‚" } },
                { speaker: "æ—ç™½", text: { zh: "ï¼ˆè€³é‚Šå‚³ä¾†ä¸€é™£è‹¥æœ‰ä¼¼ç„¡çš„ç«Šç¬‘è²ï¼Œè½èµ·ä¾†æ—¢åƒè€äººï¼Œåˆåƒå¬°å…’...ï¼‰" } }
            ],
            options: [
                { label: "å¼·è£é®å®šï¼Œå¿½è¦–å°æ–¹", action: "advance_chain", rewards: { tags: ['horror_started'], varOps: [{ key: 'sanity', val: 90, op: 'set' }] } },
                { 
                    label: "æª¢æŸ¥è²éŸ³çš„ä¾†æº", action: "node_next", 
                    rewards: { tags: ['horror_started', 'marked_by_curse'], varOps: [{ key: 'sanity', val: 80, op: 'set' }] }, 
                    nextScene: { 
                        dialogue: [{ text: { zh: "ä½ æ¹Šè¿‘ä¸€çœ‹ï¼Œé‚£è£¡ä»€éº¼éƒ½æ²’æœ‰ï¼Œåªæœ‰ä¸€åœ˜ç³¾çµçš„é»‘è‰²é«®çµ²ï¼Œæ•£ç™¼è‘—è…¥è‡­å‘³ã€‚" } }],
                        options: [{ label: "ç¹¼çºŒå‰é€²", action: "advance_chain" }]
                    } 
                }
            ]
        },
        {
            type: 'encounter_stalk', id: 'hor_psych_stalk',
            dialogue: [
                { text: { zh: "ä½ è©¦åœ–é›¢é–‹ï¼Œä½†èµ°å»Šå½·å½¿æ²’æœ‰ç›¡é ­ã€‚èº«å¾Œå‚³ä¾†äº†ã€Œå•ªå—’ã€å•ªå—’ã€çš„æ¿•é»è…³æ­¥è²ã€‚" } },
                { text: { zh: "é‚£è²éŸ³æ¥µä¸è¦å¾‹ï¼Œå°±åƒæ˜¯æŸç¨®è‚¢é«”æ‰­æ›²çš„æ±è¥¿ï¼Œæ­£æ‰‹è…³ä¸¦ç”¨åœ¨åœ°ä¸Š{atom_manner}çˆ¬è¡Œã€‚" } },
                { text: { zh: "å°æ–¹æ­£åœ¨é€¼è¿‘ï¼Œè€Œä¸”å°æ–¹çŸ¥é“ä½ åœ¨å“ªè£¡ã€‚" } },
                { speaker: "ï¼Ÿï¼Ÿï¼Ÿ", text: { zh: "å˜»å˜»... æ‰¾åˆ°... ä½ äº†..." } }
            ],
            options: [
                { 
                    label: "å±ä½å‘¼å¸ï¼Œèº²é€²æ­»è§’", style: "primary", check: { stat: 'INT', val: 5 }, action: "node_next", 
                    nextScene: { 
                        dialogue: [{ text: { zh: "ä½ æ‘€ä½å£é¼»ï¼Œå¿ƒè‡ŸåŠ‡çƒˆè·³å‹•ã€‚é‚£æ±è¥¿åœåœ¨ä½ çš„è—èº«è™•å¤–ï¼Œç™¼å‡ºäº†æŒ‡ç”²åˆ®æ“¦åœ°æ¿çš„è²éŸ³... ç„¶å¾Œæ…¢æ…¢é›¢é–‹äº†ã€‚" } }],
                        options: [{ label: "é¬†äº†ä¸€å£æ°£", action: "advance_chain" }]
                    }, 
                    failScene: { 
                        dialogue: [{ text: { zh: "ææ‡¼è®“ä½ ç™¼å‡ºäº†å–˜æ¯è²ã€‚é‚£è…³æ­¥è²ç«‹åˆ»åœäº†ä¸‹ä¾†ï¼Œç„¶å¾ŒçŒ›åœ°è½‰å‘ä½ ï¼" } }],
                        rewards: { tags: ['danger_high'], varOps: [{key:'sanity', val:20, op:'-'}] },
                        options: [{ label: "å¿«é€ƒï¼", action: "advance_chain" }]
                    } 
                },
                { 
                    label: "ä¸è¦å›é ­ï¼Œç‹‚å¥”ï¼", action: "node_next", rewards: { tags: ['risk_high'] }, 
                    nextScene: { 
                        dialogue: [{ text: { zh: "ä½ {atom_manner}å‘å‰è¡åˆºï¼Œæ„Ÿè¦ºå†°å†·çš„æ‰‹æŒ‡æ“¦éäº†ä½ çš„å¾Œé ¸..." } }],
                        options: [{ label: "æ­»å‘½é€ƒè„«", action: "advance_chain" }]
                    } 
                }
            ]
        },
		// ==========================================
        // é­é‡è¿½è¹¤ 1ï¼šæ—¥å¼éƒ½å¸‚å‚³èªª (è½è¦ºææ‡¼)
        // ==========================================
        {
            type: 'encounter_stalk', id: 'hor_stalk_weeping',
            dialogue: [
                { text: { zh: "èµ°å»Šæ·±è™•å‚³ä¾†äº†å¥³äººæ·’å²çš„å•œæ³£è²ã€‚è²éŸ³åŸæœ¬å¾ˆé ï¼Œä½†ä¸‹ä¸€ç§’ï¼Œçªç„¶æ‹‰è¿‘åˆ°äº†ä½ èº«å¾Œçš„è½‰è§’è™•ã€‚" } },
                { text: { zh: "ã€Œæ»´ç­”ã€æ»´ç­”...ã€é‚£æ˜¯æŸç¨®æ¿ƒç¨ æ¶²é«”æ»´è½çš„è²éŸ³ï¼Œä¼´éš¨è‘—æ²‰é‡çš„æ‹–æ‹½è²ã€‚" } },
                { speaker: "å¥³äººçš„è²éŸ³", text: { zh: "ã€Œç‚ºä»€éº¼... ä¸çœ‹æˆ‘... å›é ­çœ‹çœ‹æˆ‘å•Š...ã€" } },
                { text: { zh: "ä¸€è‚¡åˆºéª¨çš„å¯’æ„çˆ¬ä¸Šè„Šæ¤ï¼Œä½ çš„ç›´è¦ºç˜‹ç‹‚è­¦å‘Šä½ ï¼šçµ•å°ä¸èƒ½å›é ­ï¼" } }
            ],
            options: [
                { 
                    label: "é–‰ä¸Šçœ¼ç›ï¼Œé ç‰†è£æ­» (LUKæª¢å®š)", style: "primary", check: { stat: 'LUK', val: 6 }, action: "node_next", 
                    nextScene: { 
                        dialogue: [{ text: { zh: "ä½ å±ä½å‘¼å¸ï¼Œæ„Ÿè¦ºåˆ°ä¸€åœ˜å†°å†·ä¸”æ•£ç™¼è‘—è…¥å‘³çš„ç©ºæ°£åœåœ¨ä½ é¢å‰ã€‚è‰¯ä¹…ï¼Œé‚£è‚¡æ°£æ¯çµ‚æ–¼ç·©ç·©ç§»é–‹ï¼Œæœè‘—èµ°å»Šå¦ä¸€é ­é å»ã€‚" } }],
                        options: [{ label: "è™›è„«åœ°æ»‘ååœ¨åœ°", action: "advance_chain" }]
                    }, 
                    failScene: { 
                        dialogue: [{ text: { zh: "ä½ è©¦åœ–é–‰ä¸Šçœ¼ï¼Œä½†ææ‡¼è®“ä½ å¿ä¸ä½é¡«æŠ–äº†ä¸€ä¸‹ã€‚ä¸€é›™å†°å†·æ»‘è†©çš„æ‰‹ç¬é–“æ§ä½äº†ä½ çš„è‡‰ï¼" } }],
                        rewards: { tags: ['danger_high'], varOps: [{key:'sanity', val:25, op:'-'}] },
                        options: [{ label: "ç™¼å‡ºæ…˜å«ï¼", action: "advance_chain" }]
                    } 
                },
                { 
                    label: "æ­»å‘½å¾€å‰è·‘ï¼Œçµ•ä¸å›é ­ï¼(æ¶ˆè€—é«”åŠ›)", action: "node_next", rewards: { tags: ['risk_high'], varOps: [{key:'energy', val:10, op:'-'}] }, 
                    nextScene: { 
                        dialogue: [{ text: { zh: "ä½ {atom_manner}å‘å‰ç‹‚å¥”ï¼Œèº«å¾Œçš„å•œæ³£è²ç¬é–“è®Šæˆäº†æ·’å²çš„å°–å«ï¼ä½ ç”¨åŠ›æ’é–‹ç›¡é ­çš„é–€é€ƒäº†å‡ºå»ã€‚" } }],
                        options: [{ label: "å¤§å£å–˜æ°£", action: "advance_chain" }]
                    } 
                }
            ]
        },

        // ==========================================
        // é­é‡è¿½è¹¤ 2ï¼šå½äºº/æ¨¡ä»¿æ€ª (å¿ƒç†ææ‡¼)
        // ==========================================
        {
            type: 'encounter_stalk', id: 'hor_stalk_mimic',
            dialogue: [
                { text: { zh: "ä½ èµ°åœ¨æ˜æš—çš„é€šé“è£¡ï¼Œçªç„¶è½åˆ°å‰æ–¹å‚³ä¾†äº†ç†Ÿæ‚‰çš„è²éŸ³ã€‚" } },
                { speaker: "æœ‹å‹çš„è²éŸ³", text: { zh: "ã€Œæ•‘å‘½ï¼æˆ‘è¢«å›°åœ¨é€™è£¡äº†... æ‹œè¨—ï¼Œå¹«å¹«æˆ‘ï¼ã€" } },
                { text: { zh: "ä½ æ­£æº–å‚™ä¸Šå‰ï¼Œå»çªç„¶ç™¼ç¾é‚£è²éŸ³çš„èªèª¿ç•°å¸¸å¹³æ·¡ï¼Œå®Œå…¨æ²’æœ‰æ±‚æ•‘è€…è©²æœ‰çš„ææ…Œã€‚" } },
                { text: { zh: "æ¥è‘—ï¼Œé‚£å€‹è²éŸ³åƒå¡å¸¶ä¸€æ¨£ï¼Œé‡è¤‡äº†å®Œå…¨ä¸€æ¨¡ä¸€æ¨£çš„èªæ°£å’Œåœé “ï¼šã€æ•‘å‘½ã€‚æˆ‘è¢«å›°åœ¨ã€‚é€™è£¡äº†ã€‚ã€" } }
            ],
            options: [
                { 
                    label: "æ’¿èµ·çŸ³é ­å¾€åæ–¹å‘ä¸Ÿ (INTæª¢å®š)", check: { stat: 'INT', val: 6 }, action: "node_next", 
                    nextScene: { 
                        dialogue: [
                            { text: { zh: "ã€Œå–€å•¦ï¼ã€çŸ³é ­ç ¸åœ¨é è™•çš„éµæ¡¶ä¸Šã€‚é»‘æš—ä¸­ç«‹åˆ»å‚³ä¾†å››è‚¢ä¸¦ç”¨çš„æ€¥é€Ÿçˆ¬è¡Œè²ï¼Œæœè‘—è²éŸ³çš„æ–¹å‘è¡å»ã€‚" } },
                            { text: { zh: "è¶è‘—é€™å€‹ç©ºæª”ï¼Œä½ æ‚„æ‚„æºœé€²äº†å¦ä¸€å€‹æˆ¿é–“ã€‚" } }
                        ],
                        options: [{ label: "å®‰å…¨è„«èº«", action: "advance_chain" }]
                    }, 
                    failScene: { 
                        dialogue: [{ text: { zh: "ä½ ä¸å°å¿ƒè¸¢åˆ°äº†è…³ä¸‹çš„é‹ç½ï¼é»‘æš—ä¸­çš„è²éŸ³ç¬é–“åœæ­¢äº†ï¼Œæ¥è‘—ï¼Œä¸€å€‹å››è‚¢æ¥µåº¦æ‰­æ›²çš„ã€Œäººã€å¾é™°å½±ä¸­çŒ›ç„¶æ¢å‡ºé ­ï¼Œæ­»æ­»ç›¯è‘—ä½ ï¼" } }],
                        rewards: { tags: ['danger_high'], varOps: [{key:'sanity', val:20, op:'-'}] },
                        options: [{ label: "å¿«é€ƒï¼", action: "advance_chain" }]
                    } 
                },
                { 
                    label: "å‡è£æ²’è½åˆ°ï¼Œç·©æ­¥å¾Œé€€ (AGIæª¢å®š)", check: { stat: 'AGI', val: 5 }, action: "node_next", 
                    nextScene: { 
                        dialogue: [{ text: { zh: "ä½ åƒè²“ä¸€æ¨£æ”¾è¼•è…³æ­¥ï¼Œä¸€æ­¥æ­¥é€€å›äº†ä¸Šä¸€å€‹è·¯å£ï¼Œå®Œå…¨æ²’æœ‰é©šå‹•é‚£å€‹æ­£åœ¨å­¸äººèªªè©±çš„æ€ªç‰©ã€‚" } }],
                        options: [{ label: "é€ƒé›¢è©²å€", action: "advance_chain" }]
                    },
                    failScene: { 
                        dialogue: [{ text: { zh: "å¾Œé€€æ™‚ï¼Œä½ è¸©ç¢äº†ä¸€å¡Šç»ç’ƒã€‚é»‘æš—ä¸­çš„è²éŸ³ç«‹åˆ»è®Šæˆäº†ä¸€é™£ç‹‚å–œçš„ç¬‘è²ï¼Œæœä½ æ’²ä¾†ï¼" } }],
                        rewards: { tags: ['danger_high'], varOps: [{key:'sanity', val:15, op:'-'}, {key:'hp', val:10, op:'-'}] },
                        options: [{ label: "å¥®åŠ›æ™è„«", action: "advance_chain" }]
                    } 
                }
            ]
        },

        // ==========================================
        // é­é‡è¿½è¹¤ 3ï¼šè¦–è§’ç›²å€ (è¦–è¦ºææ‡¼/ç¾ä»£ç§‘æŠ€)
        // ==========================================
        {
            type: 'encounter_stalk', id: 'hor_stalk_camera',
            dialogue: [
                { text: { zh: "å‘¨åœçš„ç‡ˆå…‰çªç„¶å…¨éƒ¨ç†„æ»…ï¼Œä½ é™·å…¥äº†ä¼¸æ‰‹ä¸è¦‹äº”æŒ‡çš„é»‘æš—ã€‚" } },
                { text: { zh: "ä½ {atom_manner}æå‡ºæ‰‹æ©Ÿï¼Œæ‰“é–‹ç›¸æ©Ÿæ¨¡å¼ä¸¦é–‹å•Ÿé–ƒå…‰ç‡ˆï¼Œè©¦åœ–ç…§äº®å‰æ–¹çš„è·¯ã€‚" } },
                { text: { zh: "è¢å¹•ä¸Šé¡¯ç¤ºè‘—å‰æ–¹çš„ç©ºè•©èµ°å»Šï¼Œä½†ç•¶ä½ æŠŠé¡é ­ç¨å¾®åè½‰æ™‚â€”â€”" } },
                { text: { zh: "æ‰‹æ©Ÿè¢å¹•è£¡ï¼Œä¸€å€‹é«˜ç˜¦è’¼ç™½çš„äººå½±ï¼Œå°±ç­†ç›´åœ°ç«™åœ¨ä½ å·¦è‚©çš„æ­£å¾Œæ–¹ï¼ä½†ä½ çš„è‚‰çœ¼æ˜æ˜ä»€éº¼éƒ½æ²’çœ‹è¦‹ï¼" } }
            ],
            options: [
                { 
                    label: "ä¸å›é ­ï¼Œç›´æ¥è½‰èº«æ®æ‹³ï¼(STRæª¢å®š)", style: "danger", check: { stat: 'STR', val: 6 }, action: "node_next", 
                    nextScene: { 
                        dialogue: [{ text: { zh: "ä½ æ†‘è—‰è‘—è¢å¹•ä¸Šçš„ä½ç½®ï¼ŒçŒ›åœ°è½‰èº«ä¸€æ‹³æ®å‡ºï¼ä½ æ‰“ä¸­äº†æŸç¨®å†°å†·å …ç¡¬çš„æ±è¥¿ï¼Œå®ƒç™¼å‡ºäº†ä¸€è²åˆºè€³çš„å°–å˜¯ä¸¦é€€é–‹äº†ã€‚" } }],
                        rewards: { varOps: [{key:'sanity', val:10, op:'+'}] },
                        options: [{ label: "è¶æ©Ÿé€ƒè·‘", action: "advance_chain" }]
                    }, 
                    failScene: { 
                        dialogue: [{ text: { zh: "ä½ è½‰èº«æ®æ‹³ï¼Œå»åªæ‰“ä¸­äº†ç©ºæ°£ï¼ä¸‹ä¸€ç§’ï¼Œè¢å¹•è£¡çš„äººå½±çªç„¶è²¼åˆ°äº†é¡é ­å‰ï¼Œä½ çš„æ‰‹æ©Ÿè¢«ä¸€è‚¡åŠ›é‡æ‹é£›ç ¸ç¢ï¼" } }],
                        rewards: { tags: ['danger_high'], varOps: [{key:'sanity', val:30, op:'-'}] },
                        options: [{ label: "é™·å…¥é»‘æš—èˆ‡ææ…Œ", action: "advance_chain" }]
                    } 
                },
                { 
                    label: "æ­»ç›¯è‘—è¢å¹•ï¼Œå€’é€€è‘—èµ°", action: "node_next", rewards: { tags: ['risk_high'] }, 
                    nextScene: { 
                        dialogue: [
                            { text: { zh: "åªè¦ä½ çœ‹è‘—è¢å¹•ï¼Œå®ƒå°±ä¸æœƒå‹•ã€‚ä½ èˆ‰è‘—æ‰‹æ©Ÿï¼Œé›™è…¿ç™¼è»Ÿåœ°ä¸€æ­¥æ­¥å€’é€€ã€‚" } },
                            { text: { zh: "åœ¨é€€åˆ°æ¨“æ¢¯å£çš„ç¬é–“ï¼Œä½ ç«‹åˆ»è½‰èº«ç‹‚å¥”ï¼Œå†ä¹Ÿä¸æ•¢çœ‹æ‰‹æ©Ÿä¸€çœ¼ã€‚" } }
                        ],
                        options: [{ label: "é€ƒåˆ°äº®è™•", action: "advance_chain" }]
                    } 
                }
            ]
        },
		
        {
            type: 'encounter_climax', id: 'hor_psych_look',
            dialogue: [
                { text: { zh: "ç„¡è·¯å¯é€€äº†ã€‚é‚£å€‹{noun_monster}ï¼ˆæˆ–è€…èªªæ˜¯æ›¾ç¶“æ˜¯äººçš„æ±è¥¿ï¼‰å°±æ‡¸æ›åœ¨å¤©èŠ±æ¿ä¸Šã€‚" } },
                { text: { zh: "å°æ–¹çš„é ­é¡±ä»¥è©­ç•°çš„è§’åº¦è½‰äº†180åº¦ï¼Œæ­»ç™½è‰²çš„çœ¼ç æ­£æ­»æ­»ç›¯è‘—ä½ ã€‚" } },
                { text: { zh: "æ‰€æœ‰çš„æœ¬èƒ½éƒ½åœ¨å°–å«ï¼šçµ•å°ä¸èƒ½å’Œå°æ–¹å°è¦–ã€‚" } }
            ],
            options: [
                { 
                    label: "ç·Šé–‰é›™çœ¼ï¼Œå”¸èª¦ç¥ˆç¦±", action: "node_next", check: { stat: 'LUK', val: 5 }, 
                    nextScene: { 
                        dialogue: [{ text: { zh: "ä½ æ„Ÿåˆ°ä¸€è‚¡å†°å†·çš„æ°£æ¯è²¼è‘—è‡‰é °æ»‘éï¼Œè€³é‚Šæ˜¯éª¨éª¼æ‘©æ“¦çš„è„†éŸ¿... ä½†æœ€çµ‚ï¼Œå°æ–¹ä¼¼ä¹å°éœæ­¢çš„çµç‰©å¤±å»äº†èˆˆè¶£ã€‚" } }],
                        options: [{ label: "æ’éå»äº†", action: "advance_chain" }]
                    }, 
                    failScene: { 
                        dialogue: [{ text: { zh: "ä½ å¿ä¸ä½çœé–‹äº†ä¸€æ¢ç¸«... ä¸€å¼µå¸ƒæ»¿è¡€çµ²çš„è‡‰æ­£è²¼åœ¨ä½ çš„é¼»å°–å‰ï¼Œéœ²å‡ºäº†è£‚åˆ°è€³æ ¹çš„ç¬‘å®¹ã€‚" } }],
                        rewards: { varOps: [{key:'sanity', val:50, op:'-'}] },
                        options: [{ label: "æ…˜å«", action: "advance_chain" }]
                    } 
                },
                { 
                    label: "ç”¨æ‰‹é›»ç­’å¼·å…‰ç…§å°„å°æ–¹ï¼", style: "danger", action: "node_next", // ğŸŒŸ ä¿®æ­£é–ƒé€€ Bug
                    nextScene: { 
                        dialogue: [
                            { text: { zh: "å…‰ç·šç…§äº®äº†å°æ–¹çš„å…¨è²Œâ€”â€”é‚£æ™¯è±¡è¶…è¶Šäº†äººé¡ç†æ™ºçš„æ¥µé™ã€‚" } },
                            { text: { zh: "ä½ çš„æ„è­˜åœ¨å°–å«ä¸­æ–·ç·šäº†ã€‚\nã€çµå±€ï¼šç²¾ç¥å´©æ½°ã€‘" } }
                        ],
                        options: [{ label: "é™·å…¥ç˜‹ç‹‚", action: "finish_chain" }] // ğŸŒŸ åœ¨é€™è£¡æ‰çµæŸ
                    } 
                }
            ]
        },
        {
            type: 'final_survival', id: 'hor_psych_end',
            dialogue: [
                { text: { zh: "ä¸çŸ¥é“éäº†å¤šä¹…ï¼Œå‘¨åœçµ‚æ–¼æ¢å¾©äº†æ­»å¯‚ã€‚ä½ {atom_manner}æ¨é–‹é–€ï¼Œè¡é€²äº†å¤–é¢çš„é™½å…‰ä¸­ã€‚" } },
                { text: { zh: "äººç¾¤çš„å–§å›‚è²è®“ä½ æ„Ÿåˆ°ä¸€é™£ææƒšã€‚ä½ ä»¥ç‚ºä½ é€ƒæ‰äº†ã€‚" } },
                { text: { zh: "ä½†ç•¶ä½ ä½é ­çœ‹æ™‚ï¼Œç™¼ç¾è‡ªå·±çš„è…³è¸ä¸Šï¼Œå¤šäº†ä¸€å€‹é’ç´«è‰²çš„æ‰‹å°ï¼Œè€Œä¸”...é‚„åœ¨ç™¼ç‡™ã€‚" } }
            ],
            options: [{ label: "é€™åªæ˜¯ä¸€å€‹é–‹å§‹...", action: "finish_chain", rewards: { title: "å€–å­˜è€…(ï¼Ÿ)", gold: 30 } }]
        },
        
        // ============================================================
        // [é€šç”¨æ“´å……] å…¶ä»–æ‡¸ç–‘/ææ€–é–‹å ´
        // ============================================================
        {
            type: 'setup',
            id: 'mys_setup_letter',
            dialogue: [
                { text: { zh: "ä¸€åˆ‡éƒ½å§‹æ–¼é‚£å°å¥‡æ€ªçš„ä¿¡ã€‚" } },
                { text: { zh: "ä¿¡ä¸Šèªªï¼Œé—œæ–¼çœŸç›¸ï¼Œå°±è—åœ¨é€™åº§èŠåœ’è£¡ã€‚" } },
                { text: { zh: "å¤–é¢çš„{atom_weather}è®“é€™ä¸€åˆ‡é¡¯å¾—æ›´åŠ è©­ç•°ã€‚" } }
            ],
            options: [{ label: "æ¨é–‹èŠåœ’å¤§é–€", action: "advance_chain" }]
        },
        {
            type: 'setup_omen', 
            id: 'hor_setup_omen',
            dialogue: [
                { text: { zh: "ä½ ä¸è©²ä¾†é€™è£¡çš„ã€‚" } },
                { text: { zh: "{atom_weather}ï¼Œä½ çš„è»Šæ‹‹éŒ¨åœ¨äº†åŠè·¯ã€‚" } },
                { text: { zh: "é è™•é‚£æ£Ÿå»¢æ£„çš„{combo_building}ä¼¼ä¹æ˜¯ä½ å”¯ä¸€çš„é¿é›£æ‰€ã€‚" } }
            ],
            options: [{ label: "ç¡¬è‘—é ­çš®é€²å»", action: "advance_chain" }]
        },

        // ==========================================
        // é‚ªæ•™æ‘è½ä¸‰éƒ¨æ›² (Route: Cult)
        // ==========================================
        {
            type: 'setup_omen', 
            id: 'hor_cult_setup',
            dialogue: [ 
                { text: { zh: "ä½ è¿·è·¯äº†ã€‚çœ¼å‰å‡ºç¾äº†ä¸€å€‹èˆ‡ä¸–éš”çµ•çš„æ‘è½ï¼Œæ‘å£ç«‹è‘—ä¸€å°Šé¢ç›®çŒ™ç°çš„è©­ç•°ç¥åƒã€‚" } },
                { text: { zh: "æ‘æ°‘å€‘ç›´å‹¾å‹¾åœ°ç›¯è‘—ä½ ï¼Œå˜´è£¡å”¸è‘—ä½ è½ä¸æ‡‚çš„å’’èªã€‚" } },
                { text: { zh: "ä½ æ„Ÿè¦ºåˆ°ä¸€é™£å¼·çƒˆçš„æƒ¡å¯’..." } } 
            ],
            options: [
                { 
                    label: "ç¡¬è‘—é ­çš®é€²æ‘", action: "node_next", 
                    rewards: { tags: ['route_cult'], varOps: [{key:'sanity', val:100, op:'set'}] },
                    nextScene: { 
                        dialogue: [{ text: { zh: "ä½ è¸å…¥äº†æ‘èŠï¼Œèº«å¾Œçš„éœ§æ°£ç¬é–“åˆæ”ï¼Œé€€è·¯æ¶ˆå¤±äº†ã€‚" } }],
                        options: [{label: "ç¹¼çºŒ", action: "advance_chain"}] 
                    }
                }
            ]
        },
        {
            type: 'encounter_stalk', 
            id: 'hor_cult_explore',
            reqTags: ['route_cult'], // ğŸŒŸ ä¿®æ­£ï¼šæ”¹æˆé™£åˆ—éæ¿¾å™¨å¯«æ³•
            dialogue: [ 
                { text: { zh: "ä½ åœ¨æ‘é•·çš„ç©ºå±‹è£¡æœæŸ¥ã€‚å±‹å…§è²¼æ»¿äº†é»ƒè‰²çš„ç¬¦ç´™ï¼Œç¥æ¡Œä¸Šæ”¾è‘—ä¸€å€‹æœ¨ç›’ã€‚" } },
                { text: { zh: "çªç„¶ï¼Œé–€å¤–å‚³ä¾†äº†å¯†é›†çš„è…³æ­¥è²ï¼Œæ‘æ°‘å€‘åŒ…åœäº†å±‹å­ï¼" } } 
            ],
            options: [
                { 
                    label: "æ‰“é–‹æœ¨ç›’çœ‹çœ‹", action: "node_next", 
                    rewards: { tags: ['talisman'] },
                    nextScene: { 
                        dialogue: [{ text: { zh: "ç›’å­è£¡æ˜¯ä¸€å¼µç•«è‘—è¡€è‰²çœ¼ç›çš„è­·èº«ç¬¦ï¼Œä½ è¶•ç·ŠæŠŠå®ƒå¡é€²å£è¢‹ã€‚" } }],
                        options: [{label: "æº–å‚™çªåœ", action: "advance_chain"}] 
                    }
                },
                { 
                    label: "èº²é€²åºŠåº•", action: "node_next", 
                    rewards: { varOps: [{key:'sanity', val:40, op:'-'}] },
                    nextScene: { 
                        dialogue: [{ text: { zh: "ä½ èº²åœ¨åºŠåº•ï¼Œçœ‹è‘—ç„¡æ•¸é›™èµ¤è…³åœ¨æˆ¿é–“è£¡èµ°å‹•ï¼Œææ‡¼è®“ä½ çš„ç†æ™ºé–‹å§‹å´©æ½°ã€‚" } }],
                        options: [{label: "å°‹æ‰¾æ©Ÿæœƒé€ƒè·‘", action: "advance_chain"}] 
                    }
                }
            ]
        },
        {
            type: 'encounter_climax', 
            id: 'hor_cult_boss',
            reqTags: ['route_cult'], // ğŸŒŸ ä¿®æ­£ï¼šåŒä¸Š
            dialogue: [ 
                { text: { zh: "ä½ è¢«æ‘æ°‘é€¼åˆ°äº†ç¥­å£‡å‰ã€‚é‚£å€‹é¢ç›®çŒ™ç°çš„ç¥åƒç«Ÿç„¶æ´»äº†éä¾†ï¼Œå·¨å¤§çš„é™°å½±å°‡ä½ ç± ç½©ã€‚" } },
                { text: { zh: "ã€Œç•™ä¸‹ä¾†... æˆç‚ºæˆ‘å€‘çš„ä¸€éƒ¨åˆ†...ã€" } },
                { text: { zh: "ä½ çš„æ„è­˜é–‹å§‹æ¨¡ç³Šï¼Œç”Ÿæ­»å°±åœ¨ä¸€ç·šä¹‹é–“ï¼" } } 
            ],
            options: [
                { 
                    label: "é«˜èˆ‰è­·èº«ç¬¦å¿µå‡ºç ´é™¤å’’èªï¼", 
                    condition: { tags: ['talisman'], vars: [{key:'sanity', val:60, op:'>='}] },
                    style: "primary", action: "node_next", // ğŸŒŸ ä¿®æ­£é–ƒé€€ Bug
                    nextScene: { 
                        dialogue: [
                            { text: { zh: "è­·èº«ç¬¦çˆ†ç™¼å‡ºåˆºçœ¼çš„å…‰èŠ’ï¼Œç¥åƒç™¼å‡ºæ·’å²çš„æ…˜å«ä¸¦å´©è§£ï¼ä½ è¶äº‚é€ƒå‡ºäº†æ‘èŠã€‚" } },
                            { text: { zh: "ã€True End: ç ´é™¤é‚ªç¥Ÿã€‘" } }
                        ],
                        options: [{ label: "é€ƒå‡ºç”Ÿå¤©", action: "finish_chain" }] 
                    }
                },
                { 
                    label: "èƒ¡äº‚æ®èˆè­·èº«ç¬¦æ±‚ç”Ÿ", 
                    condition: { tags: ['talisman'], vars: [{key:'sanity', val:60, op:'<'}] },
                    action: "node_next", // ğŸŒŸ ä¿®æ­£é–ƒé€€ Bug
                    nextScene: { 
                        dialogue: [
                            { text: { zh: "è­·èº«ç¬¦é›–ç„¶é€¼é€€äº†æ‘æ°‘ï¼Œä½†ä½ çš„ç²¾ç¥å·²ç¶“å—åˆ°ä¸å¯é€†çš„é‡å‰µã€‚" } },
                            { text: { zh: "ã€Normal End: ç˜‹ç‹‚çš„å€–å­˜è€…ã€‘" } }
                        ],
                        options: [{ label: "å´©æ½°åœ°æ´»ä¸‹å»", action: "finish_chain" }] 
                    }
                },
                { 
                    label: "ç„¡è·¯å¯é€ƒï¼Œçµ•æœ›é–‰ä¸Šçœ¼ç›", 
                    style: "danger", action: "node_next", // ğŸŒŸ ä¿®æ­£é–ƒé€€ Bug
                    nextScene: { 
                        dialogue: [
                            { text: { zh: "ä½ é€£æŠµæŠ—çš„åŠ›æ°£éƒ½æ²’æœ‰äº†ã€‚é»‘æš—å¾¹åº•åå™¬äº†ä½ ï¼Œä½ æˆç‚ºäº†æ‘èŠçš„æ–°ç¥­å“ã€‚" } },
                            { text: { zh: "ã€Bad End: æ°¸é çš„æ‘æ°‘ã€‘" } }
                        ],
                        options: [{ label: "çµæŸ", action: "finish_chain" }] 
                    }
                }
            ]
        },

        // --- å‚™æ¡ˆ (Safety Net) ---
        {
            type: 'encounter_climax', 
            id: 'fallback_horror_climax',
            dialogue: [
                { text: { zh: "æœ€ç³Ÿç³•çš„æƒ…æ³ç™¼ç”Ÿäº†ã€‚é‚£å€‹ææ€–çš„å­˜åœ¨æ“‹ä½äº†ä½ å”¯ä¸€çš„å»è·¯ã€‚" } },
                { text: { zh: "å‘¨åœçš„ç©ºæ°£å½·å½¿çµå†°ï¼Œå¿ƒè‡Ÿåœ¨èƒ¸è…”è£¡ç‹‚è·³ã€‚" } }
            ],
            options: [{ label: "æ‹¼æ­»ä¸€æï¼", action: "advance_chain" }]
        },
        {
            type: 'final_survival', 
            id: 'fallback_horror_end',
            dialogue: [
                { text: { zh: "æ¸…æ™¨çš„ç¬¬ä¸€é“æ›™å…‰åˆºç ´äº†é»‘æš—ã€‚" } },
                { text: { zh: "ä½ æ»¿èº«æ˜¯å‚·ï¼Œä½†ä½ æ´»ä¸‹ä¾†äº†ã€‚é€™æ‰æ˜¯æœ€é‡è¦çš„ã€‚" } }
            ],
            options: [{ label: "é€ƒå‡ºç”Ÿå¤©", action: "finish_chain", rewards: { gold: 10 } }]
        },
		{
        id: 'rand_event_horror_chase',
        type: 'encounter_stalk', // è¨­å®šé—œå¡é¡å‹
        dialogue: [
            { text: "{horror_chase_start}" },
            { text: "{horror_chase_action}" },
            { text: "{horror_chase_feel}" }
        ],
        options: [
            { 
                label: "æ‹¼å‘½é€ƒè·‘ (AGIæª¢å®š)", 
                check: { stat: 'AGI', val: 5 }, 
                action: "node_next", 
                nextScene: {
                    dialogue: [{ text: "ä½ åƒéˆä¸€é«®ä¹‹éš›æ’é–‹äº†æ—é‚Šçš„é–€ï¼ŒæˆåŠŸç”©æ‰äº†å®ƒã€‚" }],
                    options: [{ label: "å–˜å£æ°£", action: "advance_chain" }]
                },
                failScene: {
                    dialogue: [{ text: "ä½ è¢«åœ°ä¸Šçš„é›œç‰©çµ†å€’äº†ï¼å®ƒç¬é–“è¿½äº†ä¸Šä¾†..." }],
                    rewards: { varOps: [{key:'hp', val:10, op:'-'}] },
                    options: [{ label: "æ­»å‘½æ™æ‰", action: "advance_chain" }]
                }
            }
        ]
    }
    );

    console.log("ğŸ•µï¸â€â™‚ï¸ ææ€–åŠ‡æœ¬å·²è¼‰å…¥");
})();